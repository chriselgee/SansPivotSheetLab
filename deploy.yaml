aws:
  profile: hammer-deploy
  region: us-east-2

tags:
  project: artifact-gen

hosts: [webserver, clients, attacker]

iam:
  name: hammer-user8675309

bucket:
  name: hammer-bucket8675309
  policy: {"Version": "2012-10-17",
      "Statement": [{
        "Sid": "AddPerm",
        "Effect": "Allow",
        "Principal": PRINCIPAL_NAME,
        "Action": ["s3:GetObject", "s3:PutObject"],
        "Resource": "arn:aws:s3:::BUCKET_NAME/*"
      }]
    }
  uploadDir: assets/
  upload: [website.tar.gz,
    userAgents.txt,
    webattacker.py,
    webattacker.service,
    webclient.py,
    webclient.service,
    webserve.service,
    urls.txt]

webserver:
  ami: ami-07f84a50d2dec2fa4
  count: 1
  download: [website.tar.gz,
    webserve.service]
  host: www.toteslegit.us
  name: WebServer
  size: t2.micro
  userdata: |
    #!/bin/bash
    whoami > /tmp/who.txt
    sudo apt update
    sudo apt -y install nmap ncat python3 python3-pip net-tools awscli tcpdump
    python3 -m pip install flask
    tar -xvf /opt/webserve.tar.gz -C /opt
    sudo systemctl enable webserve.service
    sudo systemctl start webserve.service

clients:
  ami: ami-07f84a50d2dec2fa4
  count: 2
  download: [urls.txt,
    userAgents.txt,
    webclient.py,
    webclient.service]
  name: WebClients
  size: t2.micro
  userdata: |
    #!/bin/bash
    whoami > /tmp/who.txt
    sudo apt -y install nmap ncat python3 python3-pip net-tools
    sudo pip3 install requests --upgrade
    sudo systemctl enable webclient.service
    sudo systemctl start webclient.service

attacker:
  ami: ami-07f84a50d2dec2fa4
  count: 1
  download: [webattacker.py,
    webattacker.service,
    urls.txt,
    userAgents.txt]
  name: Attacker
  size: t2.micro
  userdata: |
    #!/bin/bash
    whoami > /tmp/who.txt
    sudo apt -y install nmap ncat python3 python3-pip net-tools
    echo "Hacking for cash monies!" > /opt/secrets.txt

keypair:
  name: hammer-keypair

vpc:
  net: 10.12.0.0/16

subnet:
  net: 10.12.42.0/24

sg:
  name: hammer-sg
  desc: These are not the hammer
  ingress:
    proto: tcp
    fromPort: 22
    toPort: 8000
  egress:
    proto: tcp
    fromPort: 0
    toPort: 65535
